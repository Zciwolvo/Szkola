{% extends "base.html" %} {% block title %}User Dashboard{% endblock %} {% block
content %}
<div class="row justify-content-center mt-5">
  <div class="col-md-6">
    <h3 class="text-center">User Dashboard</h3>
    <p>Welcome to your dashboard. You can change your password below:</p>
    <a
      href="{{ url_for('change_password', user_id=current_user['ID']) }}"
      class="btn btn-warning w-100"
      >Change Password</a
    >
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const token = localStorage.getItem("token");

    if (!token) {
      window.location.href = "/login";
    }

    fetch("/user/dashboard", {
      method: "GET",
      headers: {
        Authorization: `Bearer ${token}`, // Include the JWT token in the Authorization header
      },
    })
      .then((response) => {
        if (!response.ok) {
          window.location.href = "/error?error=Unauthorized Access"; // Redirect to error page on failure
        }
      })
      .catch((error) => {
        console.error("Error loading user dashboard:", error);
      });
  });
</script>

{% endblock %}
